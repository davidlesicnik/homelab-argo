nextcloud:
  image: nextcloud:latest
  replicas: 1
  domain: nextcloud.lesicnik.eu

  persistence:
    storageClass: iscsi-storage-class
    size: 50Gi
    mountPath: /var/www/html

postgres:
  image: postgres:15
  persistence:
    size: 10Gi
    storageClass: iscsi-storage-class
  user: nextcloud
  database: nextcloud

redis:
  image: redis:latest

secrets:
  vaultPath: kv/data/nextcloud

containerPort: 80

externalSecret:
  enabled: true
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: ClusterSecretStore
  remoteRef:
    key: kv/nextcloud
  existingSecret: nextcloud-secrets

ingress:
  enabled: true
  hostname: nextcloud.lesicnik.eu
  ingressClassName: nginx
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
    nginx.ingress.kubernetes.io/use-forwarded-headers: "true"
  tls:
    enabled: false
